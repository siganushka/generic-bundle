name: CI

on:
    push:
        branches: [ main, dev ]
    pull_request:
        branches: [ main, dev ]

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v2
            - { name: Validate composer,                run: composer validate --strict }
            - { name: Composer clearcache,              run: composer clearcache }
            - { name: Install dependencies,             run: composer update }
            - { name: Run test suite,                   run: php vendor/bin/simple-phpunit --debug }
            - { name: Install dependencies (lowest),    run: composer update --prefer-lowest }
            - { name: Run test suite (lowest),          run: php vendor/bin/simple-phpunit --debug }
