name: CI

on:
    push:
        branches: [ dev ]
    pull_request:
        branches: [ dev ]

jobs:
    test:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
            - { name: Validate composer,    run: composer validate --strict }
            - { name: Composer clearcache,  run: composer clearcache }
            - { name: Install dependencies, run: composer update }
            - { name: Run tests,            run: php vendor/bin/simple-phpunit --debug }

    test-prefer-lowest:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
            - { name: Validate composer,    run: composer validate --strict }
            - { name: Composer clearcache,  run: composer clearcache }
            - { name: Install dependencies, run: composer update --prefer-lowest }
            - { name: Run tests,            run: php vendor/bin/simple-phpunit --debug }
